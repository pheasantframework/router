function d(a,t,e){const s=t.exec(a),n=e.split("/").map(r=>r.startsWith(":")?r.replace(":",""):null).filter(r=>r!==null);if(s&&s.length>1){const r={};for(let i=0;i<n.length&&i<s.length-1;i++)r[n[i]]=s[i+1];return r}else return null}function u(a){const e=`^${a.split("/").map(s=>s.startsWith(":")?"([^/]+)":s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("/")}/?$`;return new RegExp(e)}function c(a,t,e){const s=new URL(a.location.href),n=s.searchParams,r={};n.forEach((o,g)=>{r[g]=o});const i=d(s.pathname,e,t);return{name:a.location.pathname,query:r,params:i??void 0,hash:s.hash}}class l{routes;initialRoute;constructor(t="/"){this.routes=[],this.initialRoute=t}get(t,e){if(!t||!e)throw new Error("uri or callback must be given");if(typeof t!="string")throw new Error("typeof uri must be a string");if(typeof e!="function")throw new TypeError("typeof callback must be a function");this.routes.forEach(n=>{if(n.uri===t)throw new Error(`the uri ${n.uri} already exists`)});const s={uri:t,callback:e};this.routes.push(s)}init(){this.routes.find(t=>t.uri==="/")===void 0&&this.routes.push({uri:"/",callback:t=>null}),this.routes.some(t=>{const e=u(t.uri);if(window.location.pathname.match(e)){const n=c(window,t.uri,e);return t.callback.call(this,n)}})}}function p(a){return a.state??history.state}function E(a,t={}){history.replaceState(t,null,a)}class f{routes;initialRoute;constructor(t="/"){this.routes=[],this.initialRoute=t,E(t)}get(t,e){if(!t||!e)throw new Error("uri or callback must be given");if(typeof t!="string")throw new Error("typeof uri must be a string");if(typeof e!="function")throw new TypeError("typeof callback must be a function");this.routes.forEach(n=>{if(n.uri===t)throw new Error(`the uri ${n.uri} already exists`)});const s={uri:t,callback:e};this.routes.push(s)}init(){this.routes.find(t=>t.uri==="/")===void 0&&this.routes.push({uri:"/",callback:t=>null}),addEventListener("popstate",t=>{const e=p(t),s=Object.create(e,{details:{value:{},writable:!1}});this.routes.some(n=>{const r=u(n.uri);if(window.location.pathname.match(r)){const o=c(window,n.uri,r);return n.callback.call(this,o,s)}})}),addEventListener("pushstate",t=>{const e=p(t),s=Object.create(e,{details:{value:t.detail??{},writable:!1}});this.routes.some(n=>{const r=u(n.uri);if(window.location.pathname.match(r)){const o=c(window,n.uri,r);return n.callback.call(this,o,s)}})})}}const h=new CustomEvent("pushstate");function w(a,t={},e){let s=h;e&&(s=new CustomEvent("pushstate",{detail:e??{}})),history.pushState(t,null,a),dispatchEvent(s)}function m(){history.back()}Object.assign(window,{Router:l,SPARouter:f,navigateTo:w,navigateBack:m,pushEvent:h});export{l as Router,f as SPARouter,m as navigateBack,w as navigateTo,h as pushEvent};
